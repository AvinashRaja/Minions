<!DOCTYPE html>
<!--[if lt IE 7]>      <html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
<!--[if IE 7]>         <html class="no-js lt-ie9 lt-ie8"> <![endif]-->
<!--[if IE 8]>         <html class="no-js lt-ie9"> <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js"> <!--<![endif]-->
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <title>The Game</title>
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0" />
        <link rel="stylesheet" href="css/normalize.css">
        <link rel="stylesheet" href="css/main.css">        
        <script src='lib/quintus.js'></script>
        <script src='lib/quintus_sprites.js'></script>
        <script src='lib/quintus_scenes.js'></script>
        <script src='lib/quintus_input.js'></script>
        <script src='lib/quintus_anim.js'></script>
        <script src='lib/quintus_2d.js'></script>
        <script src='lib/quintus_touch.js'></script>
        <script src='lib/quintus_ui.js'></script>
        <script src="js/vendor/modernizr-2.6.2.min.js"></script>
        <style type="text/css">
			.back-link a {
				color: #4ca340;
				text-decoration: none; 
				border-bottom: 1px #4ca340 solid;
			}
			.back-link a:hover,
			.back-link a:focus {
				color: #408536; 
				text-decoration: none;
				border-bottom: 1px #408536 solid;
			}
			h1 {
				height: 100%;
				/* The html and body elements cannot have any padding or margin. */
				margin: 0;
				font-size: 14px;
				font-family: 'Open Sans', sans-serif;
				color: #1c1d1e;
				font-size: 32px;
				margin-bottom: 3px;
			}
			h2 {
				color: #fff;
				font-family: 'Open Sans', sans-serif;
				font-weight: normal;
				padding-left: 80px;
			}
			.entry-header .inner {
				text-align: left;
				margin: 0 auto 20px auto;
				width: 800px;
			}
			.entry-header { padding-top: 20px; background-color: #fff; position:fixed; top:0; width:100%; z-index:100; border-bottom: 1px #ebebeb solid;}
		</style>
    </head>
    <body class="loading">
        <!--[if lt IE 7]>
            <p class="chromeframe">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> or <a href="http://www.google.com/chromeframe/?redirect=true">activate Google Chrome Frame</a> to improve your experience.</p>
        <![endif]-->
       	
       	<header class="entry-header">
        	<div class="inner">		
				<h1 class="entry-title" style="font-family:cursive;">The Game</h1>
			</div>
		</header>
       	
       	<div class="main">
       	 
	        <section id="fadeInAnim">
	        	<div class="section-content" style="background-color:rgb(236, 180, 212)">
		    		<div class="copy-container">
                        <div style="height: 500px; width: 700px; background: red; margin-top: -50px; margin-left: -710px;">
                            <video id="movi" src="webbbb.ogg" height="500" width="700" preload controls />
                        </div>
                    </div>
		    		<div class="copy-container">
			    		<h2>Vision</h2>
<pre><code>  Students - Marketing
  Employees - Productivity
  Investors - Revenue

 Scroll Down..
</code></pre>
		    		</div>
		    		<!--img src="img/img_hero-iphone.jpg" alt="iPhone" /-->
	        	</div>
		    </section>
		    <section id="revealAnim">
		    	<div class="section-content" style="background-color:rgb(180, 208, 236)">
		    		<div class="copy-container">
			    		<!--h2></!--h2>
                        <pre><code>
                        </code></pre-->
		    		</div>
		    		<div class="images-container" style="margin-left: -500px; margin-top: -180px; width: 960px;">
			    		<img class="front" src="img/img_iphone_front.png" alt="iPhone" />
			    		<img class="back" src="img/img_iphone_back.png" alt="iPhone" />
			    		<img class="side" src="img/img_iphone_side.png" alt="iPhone" />
		    		</div>
	        	</div>
		    </section>
		    <section id="betweenSlidesAnimStart">
		    	<div class="section-content" style="background-color:rgb(236, 218, 180)">
		    		<div class="copy-container" style="margin-left: -520px; margin-top: -160px; width: 145px;">
                        <p>Use <strong>Up</strong> arrow and <strong>Down</strong> arrow and collect only FIC products.</p>
                        <code onclick="playBtn()" style="cursor:pointer;">Play</code>
		    		</div>
		    		<div class="images-container">
		    			<img class="blue" src="img/img_iphone.png" alt="" style="margin-top: -182px; margin-left: 310px;" />
		    		</div>
                    <canvas id="gameCanvas" width="670" height="404" style="margin-top: 150px; margin-left: 130px; border:0px solid red; z-index: 1;" /> 
	        	</div>
		    </section>
		    <section id="betweenSlidesAnimEnd">
		    	<!--div class="fake-content">
		    		<div class="images-container">
		    			<img class="green" src="img/img_iphone_front_green.png" alt="iPhone" style="margin-left: -160px;" />
		    		</div>
	        	</div-->
		    	<div class="section-content" style="background-color:rgb(203, 180, 236)">
		    		<div class="copy-container">
			    		<h2>Technical Summary</h2>
			    		<p>A <strong>HTML5</strong> web app developed in JavaScript using <strong>Quintus</strong> gaming framework. <strong>PhoneGap</strong> to be used to make it compatible with all platforms.</p>
		    		</div>
		    		<div class="images-container">
		    			<img class="front2" src="img/img_iphone_front_2.png" alt="Team" style="margin-left: -300px; margin-top: -25px;" />
		    		</div>
	        	</div>
		    </section>
		    
		</div>

        <script src="js/vendor/jquery-1.9.1.min.js"></script>
		<script type="text/javascript" src="js/onepagescroll/jquery.onepage-scroll.js"></script>
		<link href='js/onepagescroll/onepage-scroll.css' rel='stylesheet' type='text/css'>
        <script src="js/main.js"></script>

        <script>
            var pa = false;
            var Q = window.Q = Quintus()
                .include("Sprites, Scenes, Input, 2D, Anim, Touch, UI")
                .setup("gameCanvas") //{ width: 950, height: 540 })
                .controls().touch();

            Q.scene("gameStats", function (stage) {
                var statsContainer = stage.insert(new Q.UI.Container({
                    fill: "gray", x: 670 / 2, y: 40, border: 1, shadow: 3, shadowColor: "rgba(0,0,0,0.5)", w: 960, h: 40, opacity: 0.2,
                }));

                var lives = stage.insert(new Q.UI.Text({
                    label: "Life : 100%", color: "white", x: -200, y: 0
                }), statsContainer);

                var coins = stage.insert(new Q.UI.Text({
                    label: "Coins : 0", color: "white", x: 200, y: 0
                }), statsContainer);
            });
            Q.scene("stageStats", function (stage) {
                var statsContainer = stage.insert(new Q.UI.Container({
                    fill: "gray", x: 580, y: 115, border: 1, shadow: 2, shadowColor: "rgba(0,0,0,0.5)", w: 140, h: 80, opacity: 0.2,
                }));

                stage.insert(new Q.UI.Button({ sheet: "loan", x: -15, scale: 1.2, y: -15, opacity: 0.7 }, function () { }), statsContainer);
                var loanTxt = stage.insert(new Q.UI.Text({ label: ": -", size: 18, color: "white", x: 42, y: -16, }), statsContainer);

                stage.insert(new Q.UI.Button({ sheet: "bond", x: -16, scale: 1.2, y: 15, opacity: 0.7 }, function () { }), statsContainer);
                var bondTxt = stage.insert(new Q.UI.Text({ label: ": -", size: 18, color: "white", x: 42, y: 14, }), statsContainer);
            });

            var displayEnd = function (gameOver) {
                if (gameOver == 1)
                    Q.stageScene("endGame", 3, { label: "Game Over" });
                else
                    Q.stageScene("endGame", 3, { label: "Portfolio successfully created" });
                pa = true;
            };
            Q.scene("endGame", function (stage) {
                var container = stage.insert(new Q.UI.Container({
                    x: Q.width / 2, y: Q.height / 2, fill: "rgba(0,0,0,0.5)",
                }));
                var button = container.insert(new Q.UI.Button({
                    x: 0, y: 0, fill: "#CCCCCC", label: "stay tuned :)",
                },
                    function () { console.log('yet to impliment') }));
                var label = container.insert(new Q.UI.Text({
                    x: 0, y: -10 - button.p.h, fill: "#CCCCCC", label: stage.options.label,
                }));
                container.fit(20);
            });

            var SPRITE_BOX = 1;
            Q.gravityY = 2000;

            Q.Sprite.extend("Player", {
                init: function (p) {
                    this._super(p, {
                        sheet: "player",        // Spritesheet
                        sprite: "player",       // Animationsheet
                        x: 40,
                        y: 400,
                        jump: -850,
                        speed: 500,
                        scale: 0.4,             // scale sprite to right size
                        flip: "",
                        collisionMask: SPRITE_BOX,
                        coins: 0,
                        life: 100,
                        loan: 0,
                        bond: 0,
                    });

                    //this.p.points = [[0, 0], [20, 0], [20, 20], [0, 20]]; //Giving player points of collision
                    this.add("2d, animation");  // Add components
                },
                step: function (dt) {
                    if (pa) return;
                    this.p.vx += (this.p.speed - this.p.vx) / 4;

                    if (this.p.y > 505) {
                        this.p.y = 505;
                        this.p.landed = 1;
                        this.p.vy = 0;
                    } else {
                        this.p.landed = 0;
                    }

                    if (Q.inputs['up'] && this.p.landed > 0) {
                        this.p.vy = this.p.jump;
                    }
                    else if (Q.inputs['down'] && this.p.landed == 0) {
                        this.p.vy = -this.p.jump;
                    }

                    if (this.p.landed) {
                        this.play("walk_right");
                    } else {
                        this.play("jump");
                    }

                    if (this.p.timeInvincible > 0) {
                        this.p.timeInvincible = Math.max(this.p.timeInvincible - dt, 0);
                    } else {
                        this.p.opacity = 1;
                    }

                    this.stage.viewport.centerOn(this.p.x + 250, 400);
                },
                addCoin: function () {
                    this.p.coins++;
                    var coinsLabel = Q("UI.Text", 1).items[1];
                    coinsLabel.p.label = "Coins : " + this.p.coins;
                },
                damage: function () {
                    if (!this.p.timeInvincible) {
                        this.p.opacity = 0.5;
                        this.p.life -= 25;
                        this.p.timeInvincible = 1;
                        var lifeLabel = Q("UI.Text", 1).first();
                        lifeLabel.p.label = "Life : " + this.p.life + "%";
                        if (this.p.life == 5)
                            displayEnd(1);
                    }
                },
            });

            Q.Sprite.extend("Coin", {
                init: function () {
                    var levels = [535, 470, 410, 350, 300];// [585, 520, 460, 400, 350];

                    var player = Q("Player").first();
                    this._super({
                        x: player.p.x + Q.width + 50,
                        y: levels[Math.floor(Math.random() * 5)],
                        frame: 0,
                        scale: 1.5,
                        type: SPRITE_BOX,
                        sheet: "coin",        // Spritesheet
                        sprite: "coin",       // Animationsheet
                        vx: -100 + 200 * Math.random(),
                        vy: 0,
                        ay: 0,
                        theta: (300 * Math.random() + 200) * (Math.random() < 0.5 ? 1 : -1),
                        hasHit: false,
                    });
                    this.add("animation");
                    this.on("hit");
                },
                step: function (dt) {
                    //this.play("rotate");
                    this.p.x += this.p.vx * dt;

                    this.p.vy += this.p.ay * dt;
                    this.p.y += this.p.vy * dt;
                    if (this.p.y != 535) {
                        this.p.angle += this.p.theta * dt;
                    }

                    if (this.p.y > 800) { this.destroy(); }
                },
                hit: function (collision) {
                    this.p.type = 0;
                    this.p.collisionMask = Q.SPRITE_NONE;
                    this.p.vx = 200;
                    this.p.ay = 400;
                    this.p.vy = -300;
                    this.p.opacity = 0.5;

                    if (!this.p.hasHit)
                        collision.obj.addCoin();
                    this.p.hasHit = true;
                    this.destroy();
                }
            });

            Q.Sprite.extend("Loan", {
                init: function () {
                    var levels = [535, 470, 410, 350];

                    var player = Q("Player").first();
                    this._super({
                        x: player.p.x + Q.width + 50,
                        y: levels[Math.floor(Math.random() * 4)],
                        frame: 0,
                        scale: 1.2,
                        type: SPRITE_BOX,
                        sheet: "loan",        // Spritesheet
                        vx: -100 + 200 * Math.random(),
                        vy: 0,
                        ay: 0,
                        theta: (300 * Math.random() + 200) * (Math.random() < 0.5 ? 1 : -1),
                        hasHit: false,
                    });
                    this.add("animation");
                    this.on("hit");
                },
                step: function (dt) {
                    this.p.x += this.p.vx * dt;

                    this.p.vy += this.p.ay * dt;
                    this.p.y += this.p.vy * dt;
                    if (this.p.y != 535 && this.p.y != 410) {
                        this.p.angle += this.p.theta * dt;
                    }

                    if (this.p.y > 800) { this.destroy(); }
                },
                hit: function (collision) {
                    this.p.type = 0;
                    this.p.collisionMask = Q.SPRITE_NONE;
                    this.p.vx = 200;
                    this.p.ay = 400;
                    this.p.vy = -300;
                    this.p.opacity = 0.5;
                    if (!this.p.hasHit) {
                        collision.obj.p.loan++;
                        var lifeLabel = Q("UI.Text", 2).first();
                        lifeLabel.p.label = " : " + collision.obj.p.loan;
                        if (collision.obj.p.loan + collision.obj.p.bond >= 20)
                            displayEnd(0);
                    }
                    this.p.hasHit = true;
                    this.destroy();
                }
            });

            Q.Sprite.extend("Bond", {
                init: function () {
                    var levels = [535, 470, 410, 350];

                    var player = Q("Player").first();
                    this._super({
                        x: player.p.x + Q.width + 50,
                        y: levels[Math.floor(Math.random() * 4)],
                        frame: 0,
                        scale: 1.2,
                        type: SPRITE_BOX,
                        sheet: "bond",        // Spritesheet
                        vx: -100 + 200 * Math.random(),
                        vy: 0,
                        ay: 0,
                        theta: (300 * Math.random() + 200) * (Math.random() < 0.5 ? 1 : -1),
                        hasHit: false,
                    });
                    this.add("animation");
                    this.on("hit");
                },
                step: function (dt) {
                    this.p.x += this.p.vx * dt;

                    this.p.vy += this.p.ay * dt;
                    this.p.y += this.p.vy * dt;
                    if (this.p.y != 535 && this.p.y != 410) {
                        this.p.angle += this.p.theta * dt;
                    }

                    if (this.p.y > 800) { this.destroy(); }
                },
                hit: function (collision) {
                    this.p.type = 0;
                    this.p.collisionMask = Q.SPRITE_NONE;
                    this.p.vx = 200;
                    this.p.ay = 400;
                    this.p.vy = -300;
                    this.p.opacity = 0.5;
                    if (!this.p.hasHit) {
                        collision.obj.p.bond++;
                        var lifeLabel = Q("UI.Text", 2).items[1];
                        lifeLabel.p.label = " : " + collision.obj.p.bond;
                        if (collision.obj.p.loan + collision.obj.p.bond > 20)
                            displayEnd(0);
                    }
                    this.p.hasHit = true;
                    this.destroy();
                }
            });

            Q.Sprite.extend("Stock", {
                init: function () {
                    var levels = [535, 470, 410, 350];
                    var player = Q("Player").first();
                    this._super({
                        x: player.p.x + Q.width + 50,
                        y: levels[Math.floor(Math.random() * 4)],
                        //frame: 1,//Math.random() < 0.5 ? 1 : 0,
                        scale: 1.2,
                        type: SPRITE_BOX,
                        sheet: "stock",        // Spritesheet
                        vx: -100 + 200 * Math.random(),
                        vy: 0,
                        ay: 0,
                        theta: (300 * Math.random() + 200) * (Math.random() < 0.5 ? 1 : -1),
                        hasHit: false,
                    });
                    this.add("animation");
                    this.on("hit");
                },
                step: function (dt) {
                    this.p.x += this.p.vx * dt;

                    this.p.vy += this.p.ay * dt;
                    this.p.y += this.p.vy * dt;
                    if (this.p.y != 535 && this.p.y != 410) {
                        this.p.angle += this.p.theta * dt;
                    }

                    if (this.p.y > 800) { this.destroy(); }
                },
                hit: function (collision) {
                    this.p.type = 0;
                    this.p.collisionMask = Q.SPRITE_NONE;
                    this.p.vx = 200;
                    this.p.ay = 400;
                    this.p.vy = -300;
                    this.p.opacity = 0.5;
                    if (collision.obj.isA("Player"))
                        collision.obj.damage();
                }
            });

            Q.GameObject.extend("Thrower", {
                init: function () {
                    this.p = {
                        launchDelay: 0.75,
                        launchRandom: 1,
                        launch: 2
                    }
                },
                update: function (dt) {
                    this.p.launch -= dt;
                    var ran = [Q.Coin, Q.Bond, Q.Loan, Q.Stock];
                    if (this.p.launch < 0) {
                        this.stage.insert(new ran[Math.floor(Math.random() * 4)]());
                        this.p.launch = this.p.launchDelay + this.p.launchRandom * Math.random();
                    }
                },
                render: function () { }
            });

            Q.scene("level1", function (stage) {
                stage.insert(new Q.Repeater({ asset: "background-sky.png", speedX: 0.04 }));
                stage.insert(new Q.Repeater({ asset: "background-mount.png", repeatY: false, speedX: 0.2, y: 170 }));
                stage.insert(new Q.Repeater({ asset: "background-floor.png", repeatY: false, speedX: 0.4, y: 275, type: SPRITE_BOX }));

                stage.insert(new Q.Thrower());

                stage.insert(new Q.Player());
                stage.add("viewport");
            });

            Q.load("player.png, background-sky.png, background-mount.png, background-floor.png, coins.png, loan.png, bond.png, stock.png", function () {
                Q.sheet("player", "player.png", { "tilew": 130, "tileh": 230, "sx": 0, "sy": 0 });
                Q.sheet("coin", "coins.png", { "tilew": 32, "tileh": 36 });
                Q.sheet("loan", "loan.png", { "tilew": 71, "tileh": 28 });
                Q.sheet("bond", "bond.png", { "tilew": 71, "tileh": 28 });
                Q.sheet("stock", "stock.png", { "tilew": 80, "tileh": 24 });
                Q.animations("player", {
                    walk_left: { frames: [0, 1, 2, 3], next: 'stand_left', rate: 1 / 5 },
                    walk_right: { frames: [0, 1, 2, 3], next: 'stand_right', rate: 1 / 5 },
                    stand_left: { frames: [0] },
                    stand_right: { frames: [0] },
                    jump: { frames: [2], loop: false, rate: 1 },
                });
                Q.animations("coin", {
                    rotate: { frames: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9], rate: 1 / 5 },
                });
                Q.stageScene("level1");
                Q.stageScene("gameStats", 1);
                Q.stageScene("stageStats", 2);
            });

            Q.pauseGame();

            var playBtn = function () {
                if (pa == true) {
                    Q.clearStages();
                    Q.stageScene("level1");
                    Q.stageScene("gameStats", 1);
                    Q.stageScene("stageStats", 2);
                }
                else
                    Q.unpauseGame();
            };

        </script>

    </body>
</html>
